# Utilise une image Ubuntu 18.04 (Bionic) comme base
FROM ubuntu:18.04

# Configure le fuseau horaire pour éviter les interruptions
ENV DEBIAN_FRONTEND=noninteractive
ENV TZ=Europe/Paris

# Met à jour les paquets et installe les dépendances système
RUN apt-get update && \
    apt-get install -y --no-install-recommends \
    wget \
    curl \
    gnupg2 \
    software-properties-common \
    libxml2-dev \
    libssl-dev \
    libcurl4-openssl-dev \
    tzdata \
    && rm -rf /var/lib/apt/lists/*

# Ajoute le dépôt CRAN pour R 3.4.1
RUN echo "deb https://cloud.r-project.org/bin/linux/ubuntu bionic-cran35/" | \
    tee -a /etc/apt/sources.list
RUN apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9

# Installe R 3.4.1 
RUN apt-get update && \
    apt-get install -y --no-install-recommends \
    r-base-core=3.4.1-1bionic \
    r-recommended=3.4.1-1bionic \
    && rm -rf /var/lib/apt/lists/*

# Installe BiocManager et configure Bioconductor 3.6
RUN R -e "install.packages('BiocManager', repos='https://cran.r-project.org', dependencies=TRUE)"
RUN R -e "BiocManager::install(version = '3.6')"

# Installe DESeq2 1.16.1
RUN R -e "BiocManager::install('DESeq2', version = '1.16.1')"

# Configure le dossier de travail et copie les scripts
WORKDIR /app
COPY . .

# Définit la commande par défaut (lance R en mode interactif)
CMD ["R"]


